<?xml version="1.0"?>
<!--
/**
 * Advanced Checkout
 * 
 * NOTICE OF LICENSE
 * 
 * This source file is subject to the www.advancedcheckout.com license that is
 * available through the world-wide-web at this URL:
 * http://www.advancedcheckout.com/license-agreement
 * 
 * DISCLAIMER
 * 
 * Do not edit or add to this file if you wish to upgrade this extension to newer
 * version in the future.
 * 
 * @category 	Advanced Checkout
 * @package 	Advanced_Onestepcheckout
 * @copyright 	Copyright (c) 2015 Advanced Checkout (http://www.advancedcheckout.com/)
 * @license 	http://www.advancedcheckout.com/license-agreement
 */
-->
<config>
    <modules>
        <Advanced_Onestepcheckout>
            <version>2.6.0</version>
        </Advanced_Onestepcheckout>
    </modules>
    <admin>
        <routers>           
            <adminhtml>
                <args>
                    <modules>
                        <onestepcheckoutadmin after="Mage_Adminhtml">Advanced_Onestepcheckout</onestepcheckoutadmin>
                    </modules>
                </args>
            </adminhtml>
        </routers>
        <fieldsets>
            <customer_dataflow>
                <brazil_tax><billing>1</billing><shipping>1</shipping></brazil_tax>
            </customer_dataflow>
        </fieldsets>
    </admin>
    <adminhtml>
        <layout>
            <updates>
                <onestepcheckout>
                    <file>onestepcheckout.xml</file>
                </onestepcheckout>
            </updates>
        </layout>
        <events>
            <controller_action_layout_render_before_adminhtml_system_config_edit>
                <observers>
                    <onestepcheckout_observer>
                        <type>singleton</type>
                        <class>onestepcheckout/observer</class>
                        <method>adminhtml_system_config</method>
                    </onestepcheckout_observer>
                </observers>
            </controller_action_layout_render_before_adminhtml_system_config_edit>
        </events>
               
    </adminhtml>
    <frontend>
        <secure_url>
            <onestepcheckout>/onestepcheckout</onestepcheckout>            
        </secure_url>
        <routers>
            <onestepcheckout>
                <use>standard</use>
                <args>
                    <module>Advanced_Onestepcheckout</module>
                    <frontName>onestepcheckout</frontName>
                </args>
            </onestepcheckout>
        </routers>
        <layout>
            <updates>
                <onestepcheckout>
                    <file>onestepcheckout.xml</file>
                </onestepcheckout>
            </updates>
        </layout>
        <translate>
            <modules>
                <Advanced_Onestepcheckout>
                    <files>
                        <default>Advanced_Onestepcheckout.csv</default>
                    </files>
                </Advanced_Onestepcheckout>
            </modules>
        </translate>
        <events>
            <checkout_type_onepage_save_order>
                <observers>
                    <onestepcheckout_observer>
                        <type>model</type>
                        <class>onestepcheckout/observer</class>
                        <method>saveComment</method>
                    </onestepcheckout_observer>
                </observers>
            </checkout_type_onepage_save_order>
            <sales_order_save_after>
                <observers>
                    <onestepcheckout_observer>
                        <type>model</type>
                        <class>onestepcheckout/observer</class>
                        <method>orderSaveAfter</method>
                    </onestepcheckout_observer>
                </observers>
            </sales_order_save_after>
        </events>
    </frontend>
    <global>        
        <models>
            <onestepcheckout>
                <class>Advanced_Onestepcheckout_Model</class>
                <resourceModel>onestepcheckout_mysql4</resourceModel>
            </onestepcheckout>
            <onestepcheckout_mysql4>
                <class>Advanced_Onestepcheckout_Model_Mysql4</class>
                <entities>
                    <fieldsposition>
                        <table>onestepcheckout_field_position</table>
                    </fieldsposition>
                    <survey>
                        <table>advanced_survey</table>
                    </survey>
                </entities>
            </onestepcheckout_mysql4>
            <customer>
                <rewrite>
                    <form>Advanced_Onestepcheckout_Model_Customer_Form</form>
                    <address>Advanced_Onestepcheckout_Model_Customer_Address</address>
                </rewrite>
            </customer>
            <sales>
                <rewrite>
                    <quote_address>Advanced_Onestepcheckout_Model_Sales_Quote_Address</quote_address>
                </rewrite>
            </sales>
            <tax>
            	<rewrite>
            		<calculation>Advanced_Onestepcheckout_Model_Tax_Calculation</calculation>
            	</rewrite>
            </tax>
            <tax_mysql4>
            	<rewrite>
            		<calculation>Advanced_Onestepcheckout_Model_Mysql4_Tax_Calculation</calculation>
            	</rewrite>
            </tax_mysql4>
        </models>
        <resources>
            <onestepcheckout_setup>
                <setup>
                    <module>Advanced_Onestepcheckout</module>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </onestepcheckout_setup>
            <onestepcheckout_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </onestepcheckout_write>
            <onestepcheckout_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </onestepcheckout_read>
        </resources>
        <blocks>
            <onestepcheckout>
                <class>Advanced_Onestepcheckout_Block</class>
            </onestepcheckout>
            <checkout>
                <rewrite>
                    <links>Advanced_Onestepcheckout_Block_Links</links>
                    <onepage_link>Advanced_Onestepcheckout_Block_Onepage_Link</onepage_link>                    
                </rewrite>
            </checkout>
        </blocks>
        <helpers>
            <onestepcheckout>
                <class>Advanced_Onestepcheckout_Helper</class>
            </onestepcheckout>
            <checkout>
                <rewrite>
                    <url>Advanced_Onestepcheckout_Helper_Url</url>
                </rewrite>
            </checkout>
            
        </helpers>
        <events>
            <controller_action_postdispatch_onestepcheckout_index_saveOrder>
                <observers>
                    <hss_save_order_onepage>
                        <class>onestepcheckout/paypal_observer</class>
                        <method>setResponseAfterSaveOrder</method>
                    </hss_save_order_onepage>
                </observers>
            </controller_action_postdispatch_onestepcheckout_index_saveOrder>    
            <checkout_cart_add_product_complete>
                <observers>
                    <onestepcheckout_cart>                        
                        <class>onestepcheckout/observer</class>
                        <method>initCartController</method>
                    </onestepcheckout_cart>                    
                </observers>
            </checkout_cart_add_product_complete> 
           
        </events>
        <fieldsets>  
            <customer_address>
                <brazil_tax>
                    <to_quote_address>customer_brazil_tax</to_quote_address>                    
                </brazil_tax>
            </customer_address> 
             <sales_convert_quote_address>
                <customer_brazil_tax>
                    <to_order_address>brazil_tax</to_order_address>
                    <to_customer_address>brazil_tax</to_customer_address>
                </customer_brazil_tax>
            </sales_convert_quote_address>              
        </fieldsets>
    </global>
    <default>
        <onestepcheckout>
            <general>
                <enable>1</enable>
                <shipping_address>1</shipping_address>
                <title>One Step Checkout</title>
            </general>
            <default_setting_checkout>
                <default_payment_method></default_payment_method>
                <default_shipping_method></default_shipping_method>
                <country_id>US</country_id>
                <region_id>57</region_id>
                <default_postcode></default_postcode>
                <default_city></default_city>
            </default_setting_checkout>
            <ajax_update>
                <field_updates>country,state,postcode</field_updates>
                <action_process>0</action_process>
                <update_ajax_address>shipping_method,payment_method,order_review</update_ajax_address>
                <update_ajax_shipping>order_review</update_ajax_shipping>
            </ajax_update>
            <vat>
                <enabled>0</enabled>
                <vat_verification>0</vat_verification>
            </vat>
            <features>
                <redirect_to_checkout>0</redirect_to_checkout>
                <popupcheckout>0</popupcheckout>
                <autocomplete>0</autocomplete>
                <coupon>0</coupon>
                <term_condition>0</term_condition>
                <type_condition>system</type_condition>
                <order_comment>0</order_comment>
                <delivery_time>0</delivery_time>
                <newsletter>0</newsletter>
                <enable_survey>0</enable_survey>
            </features>
            <style>
                <design>flat</design>
                <column>3</column>
                <font>Raleway</font>
                <list_style>standard</list_style>
                <style_background_icon>slant-right</style_background_icon>
                <style_background_color_icon>20</style_background_color_icon>                
                <button>f0762b</button>
                <text_button>e9e9f2</text_button>
                <title>3399CC</title>
                <color_font>e9e9f2</color_font>
            </style>
        </onestepcheckout>
    </default>
    
</config>